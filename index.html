<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cafeteria POS</title>
<meta name="theme-color" content="#222">
<script src="https://unpkg.com/html5-qrcode"></script>

<style>
body{margin:0;font-family:Arial;background:#f4f4f4}
header{background:#222;color:#fff;padding:12px;text-align:center;font-size:18px}
.container{padding:10px}
.products{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:10px}
.product{background:#fff;padding:12px;border-radius:8px;
box-shadow:0 2px 5px rgba(0,0,0,.1);font-weight:bold;text-align:center}
.small{font-size:13px;color:#555}
.cart,.panel{background:#fff;margin-top:15px;padding:10px;border-radius:8px}
.cart-item{display:flex;justify-content:space-between;border-bottom:1px solid #ddd;padding:4px 0}
button{width:100%;padding:10px;margin-top:6px;border:none;border-radius:6px;font-size:15px;color:#fff}
.green{background:#28a745}
.red{background:#dc3545}
.blue{background:#007bff}
.gray{background:#6c757d}
.filter{display:flex;gap:6px;margin-top:8px}
.filter button{flex:1}
.hidden{display:none}
#scanner{width:100%;margin-top:10px}
</style>
</head>
<body>

<header>ðŸ“Š Cafeteria POS</header>

<div class="container">

<div class="panel">
<select id="worker">
<option>Admin 1</option><option>Admin 2</option><option>Admin 3</option>
<option>Admin 4</option><option>Admin 5</option><option>Admin 6</option><option>Admin 7</option>
</select>

<select id="shift">
<option>Morning</option>
<option>Evening</option>
</select>
</div>

<h3>Products</h3>

<div class="filter">
<button class="gray" onclick="filterCat('all')">All</button>
<button class="blue" onclick="filterCat('Drink')">Drinks</button>
<button class="green" onclick="filterCat('Food')">Food</button>
</div>

<button class="blue" onclick="addProduct()">âž• Add Product</button>
<button class="gray" onclick="startScan()">ðŸ“· Scan Barcode</button>

<div id="scanner" class="hidden"></div>

<div class="products" id="products"></div>

<div class="cart">
<h3>Current Order</h3>
<div id="cartItems"></div>
<b>Total: <span id="total">0</span> DA</b>
<button class="green" onclick="checkout()">âœ” Validate Order</button>
<button class="red" onclick="clearCart()">âœ– Clear</button>
</div>

</div>

<script>
let cart=[];
let filter="all";

let PRODUCTS = JSON.parse(localStorage.getItem("products")) || [
 {name:"Coffee",price:30,cat:"Drink",code:"111"},
 {name:"Tea",price:40,cat:"Drink",code:"222"},
 {name:"Sandwich",price:200,cat:"Food",code:"333"}
];

function save(){localStorage.setItem("products",JSON.stringify(PRODUCTS))}

function render(){
 let pDiv=document.getElementById("products");
 pDiv.innerHTML="";
 PRODUCTS.forEach((p,i)=>{
  if(filter!=="all" && p.cat!==filter) return;
  let d=document.createElement("div");
  d.className="product";
  d.innerHTML=`${p.name}<br><span class="small">${p.price} DA â€“ ${p.cat}</span>`;
  d.onclick=()=>{cart.push(p);renderCart()};
  d.oncontextmenu=e=>{
    e.preventDefault();
    if(confirm("Delete product?")){
      PRODUCTS.splice(i,1);
      save();render();
    }
  };
  pDiv.appendChild(d);
 });
}
render();

function filterCat(c){filter=c;render()}

function addProduct(){
 let name=prompt("Product name");
 if(!name) return;
 let price=parseInt(prompt("Price DA"));
 if(isNaN(price)) return;
 let cat=prompt("Category (Drink/Food)");
 let code=prompt("Barcode (optional)")||"";
 PRODUCTS.push({name,price,cat,code});
 save();render();
}

function renderCart(){
 let c=document.getElementById("cartItems");
 c.innerHTML="";
 let t=0;
 cart.forEach((p,i)=>{
  t+=p.price;
  c.innerHTML+=`${p.name} - ${p.price} DA <span onclick="remove(${i})">âœ–</span><br>`;
 });
 document.getElementById("total").innerText=t;
}
function remove(i){cart.splice(i,1);renderCart()}
function clearCart(){cart=[];renderCart()}

function checkout(){
 if(cart.length==0) return;
 cart=[];renderCart();
}

function startScan(){
 document.getElementById("scanner").classList.remove("hidden");
 const qr=new Html5Qrcode("scanner");
 qr.start({facingMode:"environment"},{fps:10,qrbox:250},
  txt=>{
   let p=PRODUCTS.find(x=>x.code===txt);
   if(p){cart.push(p);renderCart();}
   qr.stop();
   document.getElementById("scanner").classList.add("hidden");
  }
 );
}
</script>

</body>
</html>
